# Muscle Segmentation in MSOT images

This project aims at the Segmentation of Muscle Tissue in Multispectral Optoacoustic Tomography Images (MSOT).

For this purpose, an Active Deep Learning framework was be used. Active Learning (AL) is a technique that aims at maximizing a network's performance, while at the same time minimizing the total number of annotated data needed for training the model. Thus, a close-to-the baseline performance can be achieved by using just a subset of the data that the algorithm would usually train with, reducing significantly the total time needed for training and alleviating the burden of data annotation from the side of the clinicians. 

In our case, the baseline behavior was established on a UNET architecture, slightly altered by introducing batch normalization layers first, and by subsequently adding dropout layers to incorporate Uncertainty Estimation. Therefore, the technique of Monte Carlo dropout (MC-dropout) was used. MC-dropout approximates a Bayesian Neural Network by sampling from a neural network trained with dropout [27] at inference time in order to produce a distribution over the outputs. Its mathematical formulation suggests that an uncertainty map can be generated by sampling T times from the network at test time and by then computing the entropy across all classes. [T. DeVries and G. W. Taylor. Leveraging Uncertainty Estimates for Predicting Segmentation Quality.
] 

The network's pipeline has been designed as follow: Initially a classic UNET, with some dropout layers introduced is trained on the data and the segmentation mask and the uncertainty mapping are being predicted. Subsequently, a second CNN has been implemented for the quality estimation of the network, namely predict the Dice score and compare how well the network is performing.

Evaluation metrics:

The Dice Coefficient metric is being used for evaluation of UNET and the mean squared error (mse) for the vgg-like CNN.
