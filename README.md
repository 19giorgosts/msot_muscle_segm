# Muscle Segmentation in MSOT images

This project aims at the Segmentation of Muscle Tissue in Multispectral Optoacoustic Tomography Images (MSOT).

For this purpose, an Active Deep Learning framework will be used. Active Learning (AL) is a technique that aims at maximizing a network's performance, while at the same time minimizing the total number of annotated data needed for training the model. Thus, a close-to-the baseline performance can be achieved by using just a subset of the data that the algorithm would usually train with. 

In our case, the baseline behavior is established on a UNET architecture, slightly altered by introducing batch normalization layers first, and subsequently by adding dropout layers to incorporate Uncertainty Estimation. To do this, the idea of Monte Carlo dropout (MC-dropout) technique has been used. [CITE]. MC-dropout is a Bayesian Neural Network approximation and is applied at both training and inference time. Its formulation suggests that an uncertainty map can be generated by sampling T times from the network at test time and by then computing the entropy across all classes. [T. DeVries and G. W. Taylor. Leveraging Uncertainty Estimates for Predicting Segmentation Quality.
] 

The network's pipeline has been designed as follow: Initially a classic UNET, with some dropout layers introduced is trained on the data and the segmentation mask and the uncertainty mapping are being predicted. Subsequently, a second CNN has been implemented for the quality estimation of the network, namely predict the Dice score and compare how well the network is performing.

Evaluation metrics:

The Dice Coefficient metric is being used for evaluation of UNET and the mean squared error (mse) for the vgg-like CNN.
